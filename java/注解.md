### 注解

---

#### 1、使用注解
Java的注解可以分为三类：
- 第一类是由编译器使用的注解，例如：
  - @Override：让编译器检查该方法是否正确地实现了覆写；
  - @SuppressWarnings：告诉编译器忽略此处代码产生的警告。
  
这类注解不会被编译进入.class文件，它们在编译后就被编译器扔掉了。

- 第二类是由工具处理.class文件使用的注解，比如有些工具会在加载class的时候，对class做动态修改，实现一些特殊的功能。这类注解会被编译进入.class文件，但加载结束后并不会存在于内存中。这类注解只被一些底层库使用，一般我们不必自己处理。

- 第三类是在程序运行期能够读取的注解，它们在加载后一直存在于JVM中，这也是最常用的注解。例如，一个配置了@PostConstruct的方法会在调用构造方法后自动被调用（这是Java代码读取该注解实现的功能，JVM并不会识别该注解）。

定义一个注解时，还可以定义配置参数。配置参数可以包括：
- 所有基本类型；
- String；
- 枚举类型；
- 基本类型、String、Class以及枚举的数组。

因为配置参数必须是常量，所以，上述限制保证了注解在定义时就已经确定了每个参数的值。

注解的配置参数可以有默认值，缺少某个配置参数时将使用默认值。
此外，大部分注解会有一个名为value的配置参数，对此参数赋值，可以只写常量，相当于省略了value参数。

#### 2、定义注解
##### 2.1 语法
Java语言使用@interface语法来定义注解（Annotation），它的格式如下：
```aiignore
public @interface Report {
    int type() default 0;
    String level() default "info";
    String value() default "";
}
```
##### 2.2 步骤
- 第一步，用@interface定义注解：
```aiignore
public @interface Report {
}
```

- 第二步，添加参数、默认值：
```aiignore
public @interface Report {
    int type() default 0;
    String level() default "info";
    String value() default "";
}
```
把最常用的参数定义为value()，推荐所有参数都尽量设置默认值。

- 第三步，用元注解配置注解：
```aiignore
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface Report {
    int type() default 0;
    String level() default "info";
    String value() default "";
}
```
其中，必须设置@Target和@Retention，@Retention一般设置为RUNTIME，因为我们自定义的注解通常要求在运行期读取。一般情况下，不必写@Inherited和@Repeatable。

##### 2.3 元注解
- ***@Target***
最常用的元注解是@Target。使用@Target可以定义Annotation能够被应用于源码的哪些位置：
  - 类或接口：ElementType.TYPE；
  - 字段：ElementType.FIELD；
  - 方法：ElementType.METHOD；
  - 构造方法：ElementType.CONSTRUCTOR；
  - 方法参数：ElementType.PARAMETER

- ***@Retention***
@Retention定义了Annotation的生命周期，如果@Retention不存在，则该Annotation默认为CLASS：
  - 仅编译期：RetentionPolicy.SOURCE；
  - 仅class文件：RetentionPolicy.CLASS；
  - 运行期：RetentionPolicy.RUNTIME。

- ***@Repeatable***
  使用@Repeatable这个元注解可以定义Annotation是否可重复。

- ***@Inherited***
  使用@Inherited定义子类是否可继承父类定义的Annotation。@Inherited仅针对@Target(ElementType.TYPE)类型的annotation有效，并且仅针对class的继承，对interface的继承无效


